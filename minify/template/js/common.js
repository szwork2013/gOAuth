function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}String.prototype.format=function(){var e=arguments;return this.replace(/\{(\d+)\}/g,function(t,n){return e[n]})},$.eventPos=function(e){if(window.event&&!e&&(e=window.event),e.touches){var t=(e.targetTouches||e.changedTouches)[0];return t?{x:t.pageX,y:t.pageY}:{x:e.pageX,y:e.pageY}}return{x:e.clientX,y:e.clientY}},$.fn.touchMoved=function(e){var t=$(this),n=!1;return t.on("touchstart",function(a){n=a.originalEvent.touches.length>1;var r,i=$.eventPos(a.originalEvent);t.on("touchmove.touchMoved",function(e){e.preventDefault(),r=$.eventPos(e.originalEvent)}),t.one("touchend",function(a){if(r&&!n){var o=r.x-i.x,s=r.y-i.y;(o||s)&&e(o,s,a.target),t.off("touchmove.touchMoved")}}),a.stopPropagation()}),t},$.fn.tap=function(e){var t=$(this);return e?(t.on("touchstart",function(t){try{var n,a=$.eventPos(t.originalEvent),r=function(e){n=$.eventPos(e.originalEvent)};$(document.body).on("touchmove",r),$(document.body).one("touchend",function(t){if($(document.body).off("touchmove",r),n){var i=n.x-a.x,o=n.y-a.y;if(i>5||o>5)return}t.preventDefault(),e(t)})}catch(i){alert(i)}}),void(this._ontap=e)):void(this._ontap&&this._ontap())},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),$.ajax({url:"/api/wechatCertification",type:"get",data:{url:location.href},success:function(e){wx?(wx.config({beta:!1,debug:!1,appId:$("input[name=appId]").val(),timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","hideMenuItems","showAllNonBaseMenuItem","onMenuShareAppMessage"]}),wx.ready(function(){wx.showAllNonBaseMenuItem(),wx.hideMenuItems({menuList:["menuItem:share:facebook","menuItem:share:weiboApp","menuItem:share:qq","menuItem:openWithQQBrowser","menuItem:share:email","menuItem:openWithSafari","menuItem:copyUrl"]}),wx.onMenuShareTimeline({title:$("input[name=model_name]").val(),link:"https://open.weixin.qq.com/connect/oauth2/authorize?appid="+$("input[name=appId]").val()+"&redirect_uri=http://"+$("input[name=redirect_uri]").val()+"/template/m/"+$("input[name=number]").val()+"?carid="+$("input[name=carid]").val()+"&response_type=code&scope=snsapi_base&state="+$("input[name=custid]").val()+"#wechat_redirect",imgUrl:$('input[name="first-img"]').val()||"http://reg.chinaccn.cn/img/logo.ico",success:function(e){$.ajax({url:"/api/share",type:"post",data:{id:$("input[name=carid]").val()},success:function(e){alert("成功！")}})},cancel:function(e){alert("关闭！")},fail:function(e){alert("失败！")}}),wx.onMenuShareAppMessage({title:$("input[name=model_name]").val(),desc:$("input[name=remark]").val(),link:"https://open.weixin.qq.com/connect/oauth2/authorize?appid="+$("input[name=appId]").val()+"&redirect_uri=http://"+$("input[name=redirect_uri]").val()+"/template/m/"+$("input[name=number]").val()+"?carid="+$("input[name=carid]").val()+"&response_type=code&scope=snsapi_base&state="+$("input[name=custid]").val()+"#wechat_redirect",imgUrl:$('input[name="first-img"]').val()||"http://reg.chinaccn.cn/img/logo.ico",type:"link",dataUrl:"",success:function(){$.ajax({url:"/api/share",type:"post",data:{id:$("input[name=carid]").val()},success:function(e){alert("成功！")}})},cancel:function(){alert("关闭！")}})})):alert("请使用微信打开")}});var switchImg=function(){var e,t,n=!0,a=0,r=640,i=winHeight/scale;$(function(){e=$(".big-img .img"),t=e.get(0)});var o={buffer:function(e,t,n,a,r,i){function o(){c=Math.ceil((100-l)/i),l+=c;for(var o in t)s[o]=(n[o]-t[o])*l/100+t[o];a&&a.call(e,s),Math.abs(c)<1&&Math.abs(100-l)<1&&(clearInterval(e.timer),r&&r.call(e,n))}i||(i=6);var s={},l=0,c=0;e.__last_timer||(e.__last_timer=0);var u=(new Date).getTime();u-e.__last_timer>20&&(o(),e.__last_timer=u),clearInterval(e.timer),e.timer=setInterval(o,20)},flex:function(e,t,n,a,r,i,o){function s(){e.__flex_v+=(100-u)/i,e.__flex_v*=o,Math.abs(e.__flex_v)>l&&(e.__flex_v=e.__flex_v>0?l:-l),u+=e.__flex_v;for(var s in t)c[s]=(n[s]-t[s])*u/100+t[s];a&&a.call(e,c),Math.abs(e.__flex_v)<1&&Math.abs(100-u)<1&&(clearInterval(e.timer),r&&r.call(e,n),e.__flex_v=0)}var l=16;i||(i=6),o||(o=.75);var c={},u=0;e.__flex_v||(e.__flex_v=0),e.__last_timer||(e.__last_timer=0);var p=(new Date).getTime();p-e.__last_timer>20&&(s(),e.__last_timer=p),clearInterval(e.timer),e.timer=setInterval(s,20)},linear:function(e,t,n,a,r,i){function o(){l+=c;for(var i in t)s[i]=(n[i]-t[i])*l/100+t[i];a&&a.call(e,s),Math.abs(100-l)<1&&(clearInterval(e.timer),r&&r.call(e,n))}i||(i=50);var s={},l=0,c=0;e.__last_timer||(e.__last_timer=0);var u=(new Date).getTime();u-e.__last_timer>20&&(o(),e.__last_timer=u),clearInterval(e.timer),e.timer=setInterval(o,20),c=100/i},stop:function(e){clearInterval(e.timer)},move3:function(e,t,n,a,r){var i=o.addEnd;a||(a=1),r||(r="ease"),setTimeout(function(){s.setStyle3(e,"transition",sprintf("%1s all %2",a,r)),i(e,function(){s.setStyle3(e,"transition","none"),n&&n.apply(e,arguments)},t),setTimeout(function(){"function"==typeof t?t.call(e):s.setStyle(e,t)},0)},0)}},s={setStyle:function(e,t){if(e.length)for(var n=0;n<e.length;n++)s.setStyle(e[n],t);else if(2==arguments.length)for(var n in t)e.style[n]=t[n];else e.style[arguments[1]]=arguments[2]},setStyle3:function(e,t,n){e.style["Webkit"+t.charAt(0).toUpperCase()+t.substring(1)]=n,e.style["Moz"+t.charAt(0).toUpperCase()+t.substring(1)]=n,e.style["ms"+t.charAt(0).toUpperCase()+t.substring(1)]=n,e.style["O"+t.charAt(0).toUpperCase()+t.substring(1)]=n,e.style[t]=n},rnd:function(e,t){return Math.random()*(t-e)+e}},l=function(e){return a=(a+e+imgs.length)%imgs.length,imgs[a]};return{setIndex:function(e){a=e},explode:function(e){if(n){n=!1;var a=4,c=7,u=r/2,p=i/2;t.innerHTML="",t.style.background="url("+l(e)+") center no-repeat";for(var m=[],d=a*c,f=0;a>f;f++)for(var v=0,h=0;c>v;v++,h++){m[f]={left:r*v/c,top:i*f/a};var g=$("<div>");g.css({position:"absolute",width:Math.ceil(r/c)+"px",height:Math.ceil(i/a)+"px",background:"url("+now+") "+-m[f].left+"px "+-m[f].top+"px no-repeat",left:m[f].left+"px",top:m[f].top+"px"}),t.appendChild(g[0]);var y=(m[f].left+r/(2*c)-u)*s.rnd(2,3)+u-r/(2*c),x=(m[f].top+i/(2*a)-p)*s.rnd(2,3)+p-i/(2*a);setTimeout(function(a,r,i){return function(){o.buffer(a,{left:a.offsetLeft,top:a.offsetTop,opacity:100,x:0,y:0,z:0,scale:1,a:0},{left:r,top:i,opacity:0,x:s.rnd(-180,180),y:s.rnd(-180,180),z:s.rnd(-180,180),scale:s.rnd(1.5,3),a:1},function(e){this.style.left=e.left+"px",this.style.top=e.top+"px",this.style.opacity=e.opacity/100,s.setStyle3(a,"transform","perspective(500px) rotateX("+e.x+"deg) rotateY("+e.y+"deg) rotateZ("+e.z+"deg) scale("+e.scale+")")},function(){setTimeout(function(){t.removeChild(a)},200),0==--d&&(n=!0,now=l(e))},10)}}(g[0],y,x),s.rnd(0,200))}}},tile:function(e){if(n){n=!1;var a=3,c=6,u=a*c,p=Math.ceil(r/c),m=Math.ceil(i/a);t.style.background="none",t.innerHTML="";for(var d=0;c>d;d++)for(var f=0;a>f;f++){var v=document.createElement("div"),h=Math.ceil(i*f/a),g=Math.ceil(r*d/c);s.setStyle(v,{position:"absolute",background:"url("+now+") "+-g+"px "+-h+"px no-repeat",left:g+"px",top:h+"px",width:p+"px",height:m+"px"}),function(t,a,r){t.ch=!1,setTimeout(function(){o.linear(t,{y:0},{y:180},function(n){n.y>90&&!t.ch&&(t.ch=!0,t.style.background="url("+l(e)+") "+-a+"px "+-r+"px no-repeat"),n.y>90?s.setStyle3(t,"transform","perspective(500px) rotateY("+n.y+"deg) scale(-1,1)"):s.setStyle3(t,"transform","perspective(500px) rotateY("+n.y+"deg)")},function(){0==--u&&(n=!0,now=l(e))},22)},200*(d+f))}(v,g,h),t.appendChild(v)}}},bars:function(e){if(n){n=!1;var a=7,c=a,u=Math.ceil(r/a);t.style.background="none",t.innerHTML="";for(var p=0;a>p;p++){var m=document.createElement("div");s.setStyle(m,{width:u+"px",height:"100%",position:"absolute",left:r*p/a+"px",top:0}),s.setStyle3(m,"transformStyle","preserve-3d"),s.setStyle3(m,"transform","perspective(1000px) rotateX(0deg)"),function(t,r){t.style.zIndex=a/2-Math.abs(r-a/2),setTimeout(function(){o.buffer(t,{a:0,x:0},{a:100,x:-90},function(e){s.setStyle3(t,"transform","perspective(1000px) rotateY("+3*(r-a/2)*(50-Math.abs(e.a-50))/50+"deg) rotateX("+e.x+"deg)")},function(){0==--c&&(n=!0),now=l(e)},8)},130*(r+1))}(m,p),m.innerHTML="<div></div><div></div><div></div><div></div>";var d=m.getElementsByTagName("div")[0],f=m.getElementsByTagName("div")[1],v=m.getElementsByTagName("div")[2],h=m.getElementsByTagName("div")[3];s.setStyle([d,f,v,h],{width:"100%",height:"100%",position:"absolute",left:0,top:0}),s.setStyle(d,{background:"url("+l(e)+") "+-r*p/a+"px 0px no-repeat"}),s.setStyle3(d,"transform","scale3d(0.836,0.836,0.836) rotateX(90deg) translateZ("+i/2+"px)"),s.setStyle(f,{background:"url("+now+") "+-r*p/a+"px 0px no-repeat"}),s.setStyle3(f,"transform","scale3d(0.834,0.834,0.834) rotateX(0deg) translateZ("+i/2+"px)"),s.setStyle(v,{background:"#666"}),s.setStyle3(v,"transform","scale3d(0.834,0.834,0.834) rotateX(0deg) translateZ(-"+i/2+"px)"),s.setStyle(h,{background:"#666"}),s.setStyle3(h,"transform","scale3d(0.834,0.834,0.834) rotateX(90deg) translateZ(-"+i/2+"px)"),t.appendChild(m)}}},cube:function(e){if(n){n=!1,t.innerHTML="",t.style.background="none",s.setStyle3(t,"transformStyle","preserve-3d"),s.setStyle3(t,"transform","perspective(1000px) rotateY(0deg)");var a=document.createElement("div"),i=document.createElement("div");s.setStyle([a,i],{position:"absolute",width:"100%",height:"100%",left:0,top:0}),s.setStyle3(a,"transform","scale3d(0.741,0.741,0.741) rotate3d(0,1,0,0deg) translate3d(0,0,{0}px)".format(r/2)),s.setStyle3(i,"transform","scale3d(0.741,0.741,0.741) rotate3d(0,1,0,{0}deg) translate3d(0,0,{1}px)".format(e>0?90:-90,r/2)),t.appendChild(i),t.appendChild(a),a.style.background="url("+now+") center no-repeat";var c=l(e);i.style.background="url("+c+") center no-repeat",setTimeout(function(){o.flex(t,{y:0},{y:e>0?-90:90},function(e){s.setStyle3(t,"transform","perspective(1000px) rotateY("+e.y+"deg)")},function(){s.setStyle3(t,"transition","none"),s.setStyle3(t,"transformStyle","flat"),s.setStyle3(t,"transform","none"),t.innerHTML="",t.style.background="url("+c+") center no-repeat",now=c,n=!0},10,.6)},0)}},turn:function(e){if(n){n=!1,t.innerHTML="",t.style.background="url("+l(e)+") center no-repeat";var a=document.createElement("div");s.setStyle(a,{position:"absolute",background:"url("+now+") right no-repeat",zIndex:3,left:"50%",top:0,width:"50%",height:"100%",overflow:"hidden"}),s.setStyle3(a,"transform","perspective(1000px) rotateY(0deg)"),s.setStyle3(a,"transformOrigin","left"),t.appendChild(a);var r=document.createElement("div");s.setStyle(r,{position:"absolute",left:0,top:0,width:"50%",height:"100%",zIndex:2,background:"url("+now+") left no-repeat"}),t.appendChild(r);var i=document.createElement("div");s.setStyle(i,{position:"absolute",right:0,top:0,width:"50%",height:"100%",zIndex:2,background:"rgba(0,0,0,1)"}),t.appendChild(i),a.ch=!1,o.buffer(a,{y:0,opacity:1},{y:-180,opacity:0},function(t){if(t.y<-90&&!a.ch){a.ch=!0,a.innerHTML="<img />";var n=a.getElementsByTagName("img")[0];n.src=l(e),s.setStyle3(n,"transform","scaleX(-1)"),s.setStyle(n,{position:"absolute",right:0,top:0,width:"200%",height:"100%"}),s.setStyle3(a,"transformOrigin","left")}t.y<-90?s.setStyle3(a,"transform","perspective(1000px) scale(-1,1) rotateY("+(180-t.y)+"deg)"):s.setStyle3(a,"transform","perspective(1000px) rotateY("+t.y+"deg)"),i.style.background="rgba(0,0,0,"+t.opacity+")"},function(){now=l(e),n=!0},14)}}}}();$(function(){$(".grey-cover, .big-img .img").tap(function(){$(".grey-cover, .big-img").hide()}),$(".nav-pre").tap(function(){switchImg.cube(-1)}),$(".nav-next").tap(function(){switchImg.cube(1)})});